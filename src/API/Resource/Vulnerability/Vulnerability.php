<?php

declare(strict_types=1);

namespace App\API\Resource\Vulnerability;

use ApiPlatform\Metadata\ApiResource;
use App\API\Resource\Vulnerability\DTO\AffectedProduct;
use App\API\Resource\Vulnerability\DTO\BaseDescription;
use App\API\Resource\Vulnerability\DTO\BaseEvent;
use App\API\Resource\Vulnerability\DTO\BaseMetric;
use App\API\Resource\Vulnerability\DTO\BaseSource;

#[ApiResource]
final class Vulnerability
{
    public ?string $title = null;

    /**
     * @var BaseSource[]
     */
    public array $sources = [];

    /**
     * @var AffectedProduct[]
     */
    public array $products = [];

    /**
     * @var BaseDescription[]
     */
    public array $descriptions = [];

    /**
     * @var BaseEvent[]
     */
    public array $events = [];

    /**
     * @var BaseMetric[]
     */
    public array $metrics = [];

    public function __construct(
        private readonly int $id,
    ) {
    }

    public function getId(): int
    {
        return $this->id;
    }
}
